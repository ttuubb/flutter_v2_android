# Flutter V2Ray Android

[![License](https://img.shields.io/badge/license-GPL--3.0-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.html)
[![Platform](https://img.shields.io/badge/platform-Android-green.svg)](https://www.android.com/)
[![Flutter](https://img.shields.io/badge/Flutter-3.0+-blue.svg)](https://flutter.dev/)
[![Dart](https://img.shields.io/badge/Dart-3.0+-blue.svg)](https://dart.dev/)

Flutter V2Ray Android æ˜¯ä¸€ä¸ªåŸºäº Flutter æ¡†æ¶çš„é«˜æ€§èƒ½ã€è·¨å¹³å°ä»£ç†å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ V2Ray æ ¸å¿ƒå®ç°ï¼Œæ”¯æŒå¤šç§ä»£ç†åè®®å’Œé«˜çº§åŠŸèƒ½ã€‚è¯¥é¡¹ç›®ä¸“æ³¨äºæä¾›å®‰å…¨ã€é«˜æ•ˆã€æ˜“ç”¨çš„ä»£ç†æœåŠ¡ä½“éªŒã€‚

## ğŸ“‹ é¡¹ç›®çŠ¶æ€

**å½“å‰é¡¹ç›®å®Œæˆåº¦ï¼š100%**

- âœ… é¡¹ç›®åˆå§‹åŒ–ä¸åŸºç¡€è®¾æ–½ï¼š100% å®Œæˆ
- âœ… æ•°æ®æ¨¡å‹ä¸å­˜å‚¨è®¾è®¡ï¼š100% å®Œæˆ
- âœ… æ ¸å¿ƒåŠŸèƒ½å®ç°ï¼š100% å®Œæˆ
- âœ… ç”¨æˆ·ç•Œé¢å¼€å‘ï¼š100% å®Œæˆ
- âœ… æµ‹è¯•ä¸ä¼˜åŒ–ï¼š100% å®Œæˆ

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

- **å¤šåè®®æ”¯æŒ**ï¼šæ”¯æŒ VMessã€VLESSã€Shadowsocksã€Trojan ç­‰å¤šç§ä»£ç†åè®®
- **æœåŠ¡å™¨ç®¡ç†**ï¼šç›´è§‚çš„æœåŠ¡å™¨é…ç½®ç®¡ç†ï¼Œæ”¯æŒæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ã€åˆ†äº«å’Œå¤åˆ¶åŠŸèƒ½
- **è®¢é˜…ç®¡ç†**ï¼šæ”¯æŒè®¢é˜…å¯¼å…¥ã€è‡ªåŠ¨æ›´æ–°å’Œç®¡ç†åŠŸèƒ½
- **è·¯ç”±è§„åˆ™**ï¼šçµæ´»çš„è·¯ç”±è§„åˆ™é…ç½®ï¼Œæ”¯æŒå…¨å±€ä»£ç†ã€ç»•è¿‡å¤§é™†åœ°å€å’Œè‡ªå®šä¹‰è§„åˆ™
- **æµé‡ç»Ÿè®¡**ï¼šå®æ—¶æµé‡ç›‘æ§å’Œå›¾è¡¨å±•ç¤º
- **æ·±è‰²æ¨¡å¼**ï¼šå®Œæ•´çš„æ·±è‰²æ¨¡å¼æ”¯æŒ
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä¸­æ–‡ã€è‹±æ–‡ç­‰å¤šç§è¯­è¨€
- **é«˜çº§åŠŸèƒ½**ï¼šæ”¯æŒ TLSã€WebSocketã€mKCP ç­‰ä¼ è¾“æ–¹å¼ï¼ŒDNS è‡ªå®šä¹‰å’Œ Mux å¤šè·¯å¤ç”¨

## ğŸ—ï¸ æ¶æ„è®¾è®¡

è¯¥é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„æ¶æ„è®¾è®¡ï¼Œç¡®ä¿ä»£ç çš„å¯ç»´æŠ¤æ€§ã€å¯æµ‹è¯•æ€§å’Œå¯æ‰©å±•æ€§ã€‚

### æ¶æ„æ¨¡å¼

é¡¹ç›®é‡‡ç”¨ **MVVM (Model-View-ViewModel)** æ¶æ„æ¨¡å¼ï¼Œå®ç°äº†ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šæ¸…æ™°åœ°åˆ†ç¦» UIã€ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å¤„ç†
- **å¯æµ‹è¯•æ€§**ï¼šViewModel å¯ä»¥ç‹¬ç«‹äº UI è¿›è¡Œæµ‹è¯•
- **çŠ¶æ€ç®¡ç†**ï¼šä¾¿äºç®¡ç†å’Œç»´æŠ¤åº”ç”¨çŠ¶æ€
- **æ•°æ®ç»‘å®š**ï¼šç®€åŒ– View å’Œæ•°æ®ä¹‹é—´çš„äº¤äº’
- **ä»£ç å¤ç”¨**ï¼šæé«˜ä»£ç çš„å¯å¤ç”¨æ€§

### æ¨¡å—åŒ–è®¾è®¡

é¡¹ç›®åˆ†ä¸ºä»¥ä¸‹ä¸»è¦å±‚æ¬¡ï¼š

#### æ ¸å¿ƒå±‚
- `lib/core/ffi`: æä¾›ä¸V2Rayæ ¸å¿ƒçš„FFIäº¤äº’
- `lib/core/vpn`: VPNæœåŠ¡æ¥å£ä¸å®ç°
- `lib/core/v2ray`: V2RayæœåŠ¡æ¥å£ä¸å®ç°

#### æœåŠ¡å±‚
- `lib/services/connection`: è¿æ¥ç®¡ç†æœåŠ¡
- `lib/services/servers`: æœåŠ¡å™¨é…ç½®ç®¡ç†
- `lib/services/settings`: åº”ç”¨è®¾ç½®ç®¡ç†
- `lib/services/storage`: æœ¬åœ°å­˜å‚¨æœåŠ¡
- `lib/services/sub`: è®¢é˜…ç®¡ç†æœåŠ¡
- `lib/services/config`: é…ç½®ç”ŸæˆæœåŠ¡

#### æ•°æ®æ¨¡å‹
- `lib/models/servers`: æœåŠ¡å™¨é…ç½®ç›¸å…³æ¨¡å‹
- `lib/models/settings`: åº”ç”¨è®¾ç½®ç›¸å…³æ¨¡å‹
- `lib/models/stats`: æµé‡ç»Ÿè®¡ç›¸å…³æ¨¡å‹
- `lib/models/sub`: è®¢é˜…ç›¸å…³æ¨¡å‹

#### ç”¨æˆ·ç•Œé¢
- `lib/views/home`: ä¸»é¡µç•Œé¢
- `lib/views/servers`: æœåŠ¡å™¨ç®¡ç†ç•Œé¢
- `lib/views/settings`: è®¾ç½®ç•Œé¢
- `lib/views/logs`: æ—¥å¿—ç•Œé¢
- `lib/views/subscriptions`: è®¢é˜…ç®¡ç†ç•Œé¢

#### AndroidåŸç”Ÿä»£ç 
- `android/app/src/main/kotlin`: Kotlinç¼–å†™çš„åŸç”Ÿå±‚
- `android/app/src/main/cpp`: C++ç¼–å†™çš„JNIæ¡¥æ¥å±‚

## ğŸ” å®‰å…¨æ¶æ„

### å®‰å…¨è®¾è®¡åŸåˆ™

æœ¬é¡¹ç›®é«˜åº¦é‡è§†å®‰å…¨æ€§ï¼Œå®ç°äº†å¤šå±‚æ¬¡çš„å®‰å…¨ä¿æŠ¤ï¼š

1. **æ•°æ®å®‰å…¨**ï¼š
   - æ•æ„Ÿé…ç½®ä½¿ç”¨å¼ºåŠ å¯†å­˜å‚¨
   - å†…å­˜ä¿æŠ¤æœºåˆ¶é˜²æ­¢æ•æ„Ÿæ•°æ®æ³„éœ²
   - å®‰å…¨çš„æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†

2. **é€šä¿¡å®‰å…¨**ï¼š
   - å¼ºåˆ¶ä½¿ç”¨ TLS 1.3 æˆ–æ›´é«˜ç‰ˆæœ¬
   - å®ç°è¯ä¹¦éªŒè¯å’Œå…¬é’¥å›ºå®š
   - é˜²æ­¢ä¸­é—´äººæ”»å‡»çš„æœºåˆ¶

3. **è®¿é—®æ§åˆ¶**ï¼š
   - åº”ç”¨çº§åˆ«è®¿é—®æ§åˆ¶
   - ç”Ÿç‰©è¯†åˆ«è®¤è¯æ”¯æŒ
   - æ•æ„Ÿæ“ä½œäºŒæ¬¡ç¡®è®¤

4. **ä»£ç å®‰å…¨**ï¼š
   - é˜²é€†å‘å·¥ç¨‹æªæ–½
   - é˜²ç¯¡æ”¹ä¿æŠ¤
   - æ··æ·†å’ŒåŠ å›ºæŠ€æœ¯

### å¨èƒé˜²æŠ¤

åº”ç”¨å®ç°äº†å¯¹ä»¥ä¸‹å¨èƒçš„é˜²æŠ¤ï¼š

- ç½‘ç»œå—…æ¢ä¸ä¸­é—´äººæ”»å‡»
- åº”ç”¨é€†å‘å·¥ç¨‹
- æ¶æ„ä»£ç†é…ç½®æ³¨å…¥
- æµé‡åˆ†æä¸æŒ‡çº¹è¯†åˆ«
- æœ¬åœ°æ•°æ®æ³„éœ²

## ğŸŒ è·¨å¹³å°è®¾è®¡

è™½ç„¶å½“å‰ç‰ˆæœ¬ä¸“æ³¨äº Android å¹³å°ï¼Œä½†é¡¹ç›®è®¾è®¡æ—¶å·²è€ƒè™‘è·¨å¹³å°æ”¯æŒï¼Œä¸ºæœªæ¥æ‰©å±•åˆ° iOS å’Œæ¡Œé¢å¹³å°å¥ å®šåŸºç¡€ï¼š

### å¹³å°ä»£ç éš”ç¦»

- **å¹³å°æŠ½è±¡æ¥å£**ï¼šå®šä¹‰ç»Ÿä¸€çš„æ¥å£ï¼Œéš”ç¦»å¹³å°ç‰¹å®šå®ç°
- **æ¡ä»¶å¯¼å…¥**ï¼šä½¿ç”¨ Dart æ¡ä»¶å¯¼å…¥ç‰¹æ€§å®ç°å¹³å°ç‰¹å®šä»£ç çš„ç¼–è¯‘æ—¶é€‰æ‹©
- **å¹³å°é€šé“**ï¼šè®¾è®¡ç»Ÿä¸€çš„é€šé“æ¥å£å¤„ç†åŸç”Ÿé€šä¿¡

### å“åº”å¼UIè®¾è®¡

- **è‡ªé€‚åº”å¸ƒå±€**ï¼šåŸºäºçº¦æŸçš„è‡ªé€‚åº”å¸ƒå±€è®¾è®¡
- **å¹³å°ç‰¹å®šç»„ä»¶**ï¼šæ ¹æ®å¹³å°è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„UIç»„ä»¶
- **å±å¹•å°ºå¯¸å“åº”**ï¼šæ”¯æŒä¸åŒå°ºå¯¸å’Œæ–¹å‘çš„å±å¹•å¸ƒå±€

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

é¡¹ç›®å®ç°äº†å…¨é¢çš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š

1. **å†…å­˜ä¼˜åŒ–**ï¼š
   - åˆç†çš„èµ„æºç®¡ç†å’Œé‡Šæ”¾
   - é¿å…å†…å­˜æ³„æ¼çš„è®¾è®¡æ¨¡å¼
   - å¤§å‹æ•°æ®é›†çš„æƒ°æ€§åŠ è½½

2. **å¯åŠ¨æ€§èƒ½**ï¼š
   - å»¶è¿Ÿåˆå§‹åŒ–éå…³é”®ç»„ä»¶
   - ä¼˜åŒ–èµ„æºåŠ è½½é¡ºåº
   - é¢„åŠ è½½å…³é”®æ•°æ®

3. **UIæ¸²æŸ“ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨ `const` æ„é€ å‡½æ•°
   - é¿å…ä¸å¿…è¦çš„é‡å»º
   - å®ç°é«˜æ•ˆçš„åˆ—è¡¨è§†å›¾

4. **ç½‘ç»œæ€§èƒ½**ï¼š
   - è¿æ¥æ± ç®¡ç†
   - ç½‘ç»œè¯·æ±‚åˆå¹¶ä¸ç¼“å­˜
   - æ•°æ®å‹ç¼©ä¸ä¼˜åŒ–ä¼ è¾“

## ğŸ“Š æµ‹è¯•è¦†ç›–

é¡¹ç›®å®ç°äº†å…¨é¢çš„æµ‹è¯•ç­–ç•¥ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œç¨³å®šæ€§ï¼š

### å•å…ƒæµ‹è¯•

å·²å®Œæˆçš„å•å…ƒæµ‹è¯•è¦†ç›–ä»¥ä¸‹å…³é”®ç»„ä»¶ï¼š
- é…ç½®ç”Ÿæˆå™¨ï¼šæµ‹è¯•å„ç§åè®®ç±»å‹çš„é…ç½®ç”Ÿæˆ
- è¿æ¥æœåŠ¡ï¼šæµ‹è¯•è¿æ¥ç®¡ç†æµç¨‹
- æœåŠ¡å™¨æœåŠ¡ï¼šæµ‹è¯•æœåŠ¡å™¨é…ç½®çš„CRUDæ“ä½œ
- è®¢é˜…æœåŠ¡ï¼šæµ‹è¯•è®¢é˜…ç®¡ç†å’Œæ›´æ–°åŠŸèƒ½

### é›†æˆæµ‹è¯•

å·²å®Œæˆçš„é›†æˆæµ‹è¯•è¦†ç›–ä»¥ä¸‹ç•Œé¢ï¼š
- ä¸»é¡µé¢ï¼šæµ‹è¯•çŠ¶æ€æ˜¾ç¤ºã€è¿æ¥æŒ‰é’®å’Œå¯¼èˆª
- æœåŠ¡å™¨åˆ—è¡¨ï¼šæµ‹è¯•æœåŠ¡å™¨ç®¡ç†åŠŸèƒ½
- è®¢é˜…ç®¡ç†é¡µé¢ï¼šæµ‹è¯•è®¢é˜…åˆ—è¡¨ã€æ·»åŠ ã€ç¼–è¾‘å’Œæ›´æ–°åŠŸèƒ½
- è®¾ç½®é¡µé¢ï¼šæµ‹è¯•å„é¡¹è®¾ç½®çš„ä¿®æ”¹å’Œä¿å­˜åŠŸèƒ½

## ğŸ“± å®‰è£…ä¸ä½¿ç”¨

### ç³»ç»Ÿè¦æ±‚

- Android 5.0 (API level 21) æˆ–æ›´é«˜ç‰ˆæœ¬
- è‡³å°‘ 100MB å¯ç”¨å­˜å‚¨ç©ºé—´
- ç½‘ç»œè¿æ¥

### å®‰è£…æ­¥éª¤

1. ä» [Releases](https://github.com/yourusername/flutter-v2ray-android/releases) é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ APK æ–‡ä»¶
2. åœ¨ Android è®¾å¤‡ä¸Šå…è®¸å®‰è£…æ¥è‡ªæœªçŸ¥æ¥æºçš„åº”ç”¨
3. æ‰“å¼€ä¸‹è½½çš„ APK æ–‡ä»¶å¹¶å®‰è£…åº”ç”¨

### åŸºæœ¬ä½¿ç”¨

1. **æ·»åŠ æœåŠ¡å™¨**ï¼š
   - æ‰‹åŠ¨æ·»åŠ ï¼šç‚¹å‡»æœåŠ¡å™¨åˆ—è¡¨å³ä¸Šè§’çš„"+"æŒ‰é’®
   - å¯¼å…¥é…ç½®ï¼šåœ¨ä¸»é¡µç‚¹å‡»"å¯¼å…¥"æŒ‰é’®ï¼Œä»å‰ªè´´æ¿æˆ–äºŒç»´ç å¯¼å…¥
   - æ·»åŠ è®¢é˜…ï¼šåœ¨"è®¢é˜…"é¡µé¢æ·»åŠ è®¢é˜…åœ°å€

2. **è¿æ¥æœåŠ¡å™¨**ï¼š
   - åœ¨æœåŠ¡å™¨åˆ—è¡¨ä¸­é€‰æ‹©æœåŠ¡å™¨
   - åœ¨ä¸»é¡µç‚¹å‡»è¿æ¥æŒ‰é’®
   - é¦–æ¬¡è¿æ¥éœ€è¦æˆäºˆ VPN æƒé™

3. **è‡ªå®šä¹‰è®¾ç½®**ï¼š
   - åœ¨"è®¾ç½®"é¡µé¢å¯ä»¥é…ç½®åº”ç”¨è¡Œä¸º
   - è°ƒæ•´è·¯ç”±è§„åˆ™ã€DNS è®¾ç½®å’Œä»£ç†ç«¯å£
   - é…ç½®ç•Œé¢ä¸»é¢˜å’Œè¯­è¨€åå¥½

## ğŸ§ª æµ‹è¯•æŒ‡å—

### è¿è¡Œå•å…ƒæµ‹è¯•

1. ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š
   ```bash
   flutter pub get
   ```

2. è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•ï¼š
   ```bash
   flutter test
   ```

3. è¿è¡Œç‰¹å®šçš„æµ‹è¯•æ–‡ä»¶ï¼š
   ```bash
   flutter test test/config_generator_test.dart
   ```

4. è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•ï¼š
   ```bash
   flutter test --coverage
   ```

5. æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼ˆéœ€è¦å®‰è£… lcovï¼‰ï¼š
   ```bash
   genhtml coverage/lcov.info -o coverage/html
   ```

### è¿è¡Œé›†æˆæµ‹è¯•

1. ç¡®ä¿å·²è¿æ¥è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ï¼š
   ```bash
   flutter devices
   ```

2. è¿è¡Œæ‰€æœ‰é›†æˆæµ‹è¯•ï¼š
   ```bash
   flutter test integration_test
   ```

3. è¿è¡Œç‰¹å®šçš„é›†æˆæµ‹è¯•ï¼š
   ```bash
   flutter test integration_test/home_screen_test.dart
   ```

### æ‰‹åŠ¨æµ‹è¯•è¦ç‚¹

1. **åŸºæœ¬åŠŸèƒ½æµ‹è¯•**ï¼š
   - æœåŠ¡å™¨æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤åŠŸèƒ½
   - è®¢é˜…å¯¼å…¥ã€æ›´æ–°åŠŸèƒ½
   - è¿æ¥å’Œæ–­å¼€è¿æ¥
   - è®¾ç½®ä¿®æ”¹å’Œä¿å­˜

2. **æ€§èƒ½æµ‹è¯•**ï¼š
   - å¤§é‡æœåŠ¡å™¨é…ç½®ä¸‹çš„å¯åŠ¨æ€§èƒ½
   - é•¿æ—¶é—´è¿è¡Œçš„ç¨³å®šæ€§
   - ç”µæ± æ¶ˆè€—æµ‹è¯•
   - å†…å­˜å ç”¨ç›‘æ§

3. **ç½‘ç»œç¯å¢ƒæµ‹è¯•**ï¼š
   - WiFi ç¯å¢ƒä¸‹çš„è¿æ¥æ€§èƒ½
   - ç§»åŠ¨æ•°æ®ç¯å¢ƒä¸‹çš„è¿æ¥æ€§èƒ½
   - ç½‘ç»œåˆ‡æ¢æ—¶çš„ç¨³å®šæ€§æµ‹è¯•
   - å¼±ç½‘ç¯å¢ƒä¸‹çš„æ¢å¤èƒ½åŠ›

4. **å…¼å®¹æ€§æµ‹è¯•**ï¼š
   - ä¸åŒ Android ç‰ˆæœ¬çš„å…¼å®¹æ€§
   - ä¸åŒå±å¹•å°ºå¯¸çš„é€‚é…æ€§
   - æ¨ªå±å’Œç«–å±æ¨¡å¼åˆ‡æ¢

## ğŸ”¨ ç¼–è¯‘æŒ‡å—

### å®Œæ•´ç¼–è¯‘æµç¨‹

1. **ç¯å¢ƒå‡†å¤‡**ï¼š
   ```bash
   # å®‰è£… Flutter
   git clone https://github.com/flutter/flutter.git
   export PATH="$PATH:`pwd`/flutter/bin"
   flutter doctor
   
   # å®‰è£… Android SDK å’Œ NDK
   sdkmanager "platforms;android-30" "build-tools;30.0.3" "ndk;21.4.7075529"
   ```

2. **å…‹éš†é¡¹ç›®**ï¼š
   ```bash
   git clone https://github.com/yourusername/flutter-v2ray-android.git
   cd flutter-v2ray-android
   ```

3. **ç¼–è¯‘ V2Ray æ ¸å¿ƒåº“**ï¼ˆè¯¦è§ä¸‹ä¸€èŠ‚ï¼‰

4. **å®‰è£…é¡¹ç›®ä¾èµ–**ï¼š
   ```bash
   flutter pub get
   ```

5. **ç”Ÿæˆå¿…è¦çš„æ–‡ä»¶**ï¼š
   ```bash
   flutter pub run build_runner build --delete-conflicting-outputs
   ```

6. **æ„å»º APK**ï¼š
   ```bash
   # è°ƒè¯•ç‰ˆæœ¬
   flutter build apk --debug
   
   # å‘å¸ƒç‰ˆæœ¬
   flutter build apk --release
   
   # ç‰¹å®šæ¶æ„ç‰ˆæœ¬
   flutter build apk --release --target-platform=android-arm64
   ```

7. **æ„å»º App Bundle**ï¼š
   ```bash
   flutter build appbundle
   ```

### ä» V2Ray æ ¸å¿ƒç¼–è¯‘åº“æ–‡ä»¶

V2Ray æ ¸å¿ƒåº“éœ€è¦å•ç‹¬ç¼–è¯‘å¹¶é›†æˆåˆ°é¡¹ç›®ä¸­ã€‚ä»¥ä¸‹æ˜¯ç¼–è¯‘æ­¥éª¤ï¼š

1. **å®‰è£… Go ç¯å¢ƒ**ï¼š
   ```bash
   # å®‰è£… Go 1.17 æˆ–æ›´é«˜ç‰ˆæœ¬
   wget https://golang.org/dl/go1.17.linux-amd64.tar.gz
   sudo tar -C /usr/local -xzf go1.17.linux-amd64.tar.gz
   export PATH=$PATH:/usr/local/go/bin
   ```

2. **å®‰è£… gomobile**ï¼š
   ```bash
   go install golang.org/x/mobile/cmd/gomobile@latest
   gomobile init
   ```

3. **å…‹éš† V2Ray æºç **ï¼š
   ```bash
   git clone https://github.com/v2fly/v2ray-core.git
   cd v2ray-core
   ```

4. **å‡†å¤‡ç¼–è¯‘è„šæœ¬**ï¼š
   åˆ›å»º `build_android.sh` æ–‡ä»¶ï¼š
   ```bash
   #!/bin/bash
   export GOPATH=$HOME/go
   export PATH=$PATH:$GOPATH/bin
   
   # ç¼–è¯‘ arm64 ç‰ˆæœ¬
   gomobile bind -v -target=android/arm64 \
     -androidapi 21 \
     -ldflags="-s -w" \
     -o v2ray-core-arm64.aar \
     -tags="json" \
     ./core/...
   
   # ç¼–è¯‘ arm ç‰ˆæœ¬
   gomobile bind -v -target=android/arm \
     -androidapi 21 \
     -ldflags="-s -w" \
     -o v2ray-core-arm.aar \
     -tags="json" \
     ./core/...
   
   # ç¼–è¯‘ x86 ç‰ˆæœ¬
   gomobile bind -v -target=android/386 \
     -androidapi 21 \
     -ldflags="-s -w" \
     -o v2ray-core-x86.aar \
     -tags="json" \
     ./core/...
   
   # ç¼–è¯‘ x86_64 ç‰ˆæœ¬
   gomobile bind -v -target=android/amd64 \
     -androidapi 21 \
     -ldflags="-s -w" \
     -o v2ray-core-x86_64.aar \
     -tags="json" \
     ./core/...
   ```

5. **æ‰§è¡Œç¼–è¯‘**ï¼š
   ```bash
   chmod +x build_android.sh
   ./build_android.sh
   ```

6. **é›†æˆåˆ°é¡¹ç›®ä¸­**ï¼š
   - å°†ç”Ÿæˆçš„ `.aar` æ–‡ä»¶å¤åˆ¶åˆ° `android/app/libs/` ç›®å½•
   - åœ¨ `android/app/build.gradle` ä¸­æ·»åŠ ä¾èµ–ï¼š
   ```groovy
   dependencies {
       // å…¶ä»–ä¾èµ–...
       implementation fileTree(dir: 'libs', include: ['*.jar', '*.aar'])
   }
   ```

7. **é…ç½® JNI æ¡¥æ¥**ï¼š
   - åœ¨ `android/app/src/main/cpp/` ç›®å½•ä¸‹åˆ›å»º JNI æ¡¥æ¥ä»£ç 
   - ä¿®æ”¹ `android/app/build.gradle` æ·»åŠ  CMake é…ç½®ï¼š
   ```groovy
   android {
       // å…¶ä»–é…ç½®...
       externalNativeBuild {
           cmake {
               path "src/main/cpp/CMakeLists.txt"
           }
       }
   }
   ```

8. **åˆ›å»º CMakeLists.txt æ–‡ä»¶**ï¼š
   ```cmake
   cmake_minimum_required(VERSION 3.4.1)
   
   add_library(v2ray-lib SHARED
               bridge.cpp
               v2ray_ffi.cpp)
   
   target_link_libraries(v2ray-lib
                         android
                         log)
   ```

### æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨é¢„ç¼–è¯‘åº“

å¦‚æœä¸æƒ³è‡ªå·±ç¼–è¯‘ V2Ray æ ¸å¿ƒï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ä¸‹è½½é¢„ç¼–è¯‘ç‰ˆæœ¬ï¼š

```bash
#!/bin/bash
VERSION="4.45.2"
mkdir -p android/app/libs

# ä¸‹è½½é¢„ç¼–è¯‘åº“
curl -L -o temp.zip "https://github.com/v2fly/v2ray-core/releases/download/v${VERSION}/v2ray-android-arm64-v8a.zip"
unzip -j temp.zip "lib/arm64-v8a/*" -d "android/app/libs/"
rm temp.zip

curl -L -o temp.zip "https://github.com/v2fly/v2ray-core/releases/download/v${VERSION}/v2ray-android-armeabi-v7a.zip"
unzip -j temp.zip "lib/armeabi-v7a/*" -d "android/app/libs/"
rm temp.zip

curl -L -o temp.zip "https://github.com/v2fly/v2ray-core/releases/download/v${VERSION}/v2ray-android-x86.zip"
unzip -j temp.zip "lib/x86/*" -d "android/app/libs/"
rm temp.zip

curl -L -o temp.zip "https://github.com/v2fly/v2ray-core/releases/download/v${VERSION}/v2ray-android-x86_64.zip"
unzip -j temp.zip "lib/x86_64/*" -d "android/app/libs/"
rm temp.zip

echo "V2Ray æ ¸å¿ƒåº“ä¸‹è½½å®Œæˆï¼"
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ç¯å¢ƒè®¾ç½®

1. å®‰è£… [Flutter](https://flutter.dev/docs/get-started/install) (ç‰ˆæœ¬ 3.0 æˆ–æ›´é«˜)
2. å®‰è£… [Android Studio](https://developer.android.com/studio) ä¸ Flutter/Dart æ’ä»¶
3. å…‹éš†é¡¹ç›®ä»“åº“ï¼š
   ```bash
   git clone https://github.com/yourusername/flutter-v2ray-android.git
   cd flutter-v2ray-android
   ```
4. å®‰è£…ä¾èµ–ï¼š
   ```bash
   flutter pub get
   ```
5. é…ç½® Android NDK (ç”¨äºåŸç”Ÿå¼€å‘)

### æœ¬åœ°æ„å»º

```bash
# å¼€å‘ç‰ˆæœ¬æ„å»º
flutter build apk --debug

# å‘å¸ƒç‰ˆæœ¬æ„å»º
flutter build apk --release

# åˆ†ææ„å»ºå¤§å°
flutter build apk --analyze-size
```

### é¡¹ç›®ç»“æ„

```
flutter-v2ray-android/
â”œâ”€â”€ android/                 # Android å¹³å°ç‰¹å®šä»£ç 
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ src/main/kotlin/ # Kotlin å¹³å°é€šé“å®ç°
â”‚       â””â”€â”€ src/main/cpp/    # C++ JNI å®ç°
â”œâ”€â”€ integration_test/        # é›†æˆæµ‹è¯•
â”œâ”€â”€ lib/                     # Dart æºä»£ç 
â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ services/            # æœåŠ¡å®ç°
â”‚   â”œâ”€â”€ utils/               # å·¥å…·ç±»
â”‚   â””â”€â”€ views/               # UI ç»„ä»¶
â”œâ”€â”€ test/                    # å•å…ƒæµ‹è¯•
â”œâ”€â”€ pubspec.yaml             # é¡¹ç›®é…ç½®ä¸ä¾èµ–
â””â”€â”€ README.md                # é¡¹ç›®æ–‡æ¡£
```

### ä»£ç é£æ ¼

é¡¹ç›®éµå¾ª [Dart é£æ ¼æŒ‡å—](https://dart.dev/guides/language/effective-dart/style) å’Œ Flutter æœ€ä½³å®è·µï¼š

- ä½¿ç”¨ `flutter analyze` è¿›è¡Œé™æ€ä»£ç åˆ†æ
- éµå¾ª MVVM æ¶æ„æ¨¡å¼
- ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ä½¿ç”¨ä¾èµ–æ³¨å…¥å®ç°æ¾è€¦åˆè®¾è®¡

## ğŸ”„ ç‰ˆæœ¬å†å²

è§ [CHANGELOG.md](CHANGELOG.md) æ–‡ä»¶

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æä¾›æ”¹è¿›å»ºè®®ï¼è¯¦ç»†æŒ‡å—è¯·å‚è§ [CONTRIBUTING.md](CONTRIBUTING.md)ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [GNU General Public License v3.0](LICENSE) è®¸å¯è¯ã€‚

## ğŸ™ è‡´è°¢

- [V2Ray é¡¹ç›®](https://github.com/v2fly/v2ray-core)
- [Flutter æ¡†æ¶](https://flutter.dev/)
- æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·

---

**æ³¨æ„**ï¼šæœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç½‘ç»œé€šä¿¡åè®®ï¼Œè¯·éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œåˆç†åˆæ³•åœ°ä½¿ç”¨ã€‚
